<?php

/**
 * This class has been auto-generated by the Doctrine ORM Framework
 */
abstract class BaseAcl extends Doctrine_Record
{
	public function setTableDefinition()
	{
		$this->setTableName('security_acl');
		
		$this->hasColumn('id', 'integer', 4, array(
			'unsigned'		=>	true,
			'primary'		=>	true,
			'notnull'		=>	true,
			'autoincrement'	=>	true));
			
		$this->hasColumn('module_id', 'integer', 4, array(
            'unsigned'      =>  true,
            'primary'       =>  false,
            'notnull'       =>  true,
            'autoincrement' =>  false));
		
		$this->hasColumn('resource_id', 'integer', 4, array(
            'unsigned'      =>  true,
            'primary'       =>  false,
            'notnull'       =>  true,
            'autoincrement' =>  false));
		
		$this->hasColumn('privilege_id', 'integer', 4, array(
            'unsigned'      =>  true,
            'primary'       =>  false,
            'notnull'       =>  true,
            'autoincrement' =>  false));
		
		$this->index('UNIQUE', array(
			'fields'		=>	array('module_id', 'resource_id', 'privilege_id'),
			'type'			=>	'unique'));
	}

	public function setUp()
	{
		parent::setUp();
		
		$this->hasOne('AclPart as Module', array(
			'local'		=>	'module_id',
			'foreign'	=>	'id',
			'onDelete'	=>	'CASCADE',
		    'onUpdate'  =>  'CASCADE'));
		
		$this->hasOne('AclPart as Resource', array(
            'local'     =>  'resource_id',
            'foreign'   =>  'id',
            'onDelete'  =>  'CASCADE',
            'onUpdate'  =>  'CASCADE'));
		
		$this->hasOne('AclPart as Privilege', array(
            'local'     =>  'privilege_id',
            'foreign'   =>  'id',
            'onDelete'  =>  'CASCADE',
            'onUpdate'  =>  'CASCADE'));
			
		$this->hasMany('Group as Groups', array(
			'local'		=>	'acl_id',
			'foreign'	=>	'group_id',
			'refClass'	=>	'GroupAcl'));
	}
}